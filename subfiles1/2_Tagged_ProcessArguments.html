<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>JabRef.java</title></head>
<body>
<line class = "methodSg" >1  <function><specifier>public</specifier> Vector<argument_list type="generic">&lt;<argument>ParserResult</argument>&gt;</argument_list> processArguments<parameter_list>(<parameter><decl>String<index>[]</index> args</decl></parameter>, <parameter><decl>boolean initialStartup</decl></parameter>)</parameter_list> <block>{<br/></block></function></line>
<line class = "Asignmt"  >2  <br/></line>
<line class = "nothing"  >3  &nbsp;&nbsp;&nbsp;cli <operator>=</operator> <operator>new</operator> <call>JabRefCLI<argument_list>(<argument>args</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >4  <br/></line>
<line class = "controlS" >5  &nbsp;&nbsp;&nbsp;<if>if <condition>(initialStartup <operator>&amp;&amp;</operator> <call>cli<operator>.</operator>isShowVersion<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "Asignmt"  >6  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>cli<operator>.</operator>displayVersion<argument_list>()</argument_list></call>;<br/></line>
<line class = "nothing"  >7  &nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >8  <br/></line>
<line class ="controlS"  >9  &nbsp;&nbsp;&nbsp;<if>if <condition>(initialStartup <operator>&amp;&amp;</operator> <call>cli<operator>.</operator>isHelp<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></line>
<line class ="print"     >10 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>cli<operator>.</operator>printUsage<argument_list>()</argument_list></call>;<br/></line>
<line class = "return"   >11 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<return>return <literal type="null">null</literal>;</return> <comment type="line">// TODO replace with optional one day</comment><br/></line>
<line class = "nothing"  >12 &nbsp;&nbsp;&nbsp;}</block></then></if><br/></line>
<line class = "nothing"  >13 <br/></line>
<line class = "nothing"  >14 &nbsp;&nbsp;&nbsp;<comment type="line">// Check if we should reset all preferences to default values:</comment><br/></line>
<line class = "controlS" >15 &nbsp;&nbsp;&nbsp;<if>if <condition>(<call>cli<operator>.</operator>isPreferencesReset<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></line>
<line class = "Asignmt"  >16 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>String value <init>= <call>cli<operator>.</operator>getPreferencesReset<argument_list>()</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "controlS" >17 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<literal type="string">"all"</literal><operator>.</operator><call>equals<argument_list>(<argument><call>value<operator>.</operator>trim<argument_list>()</argument_list></call></argument>)</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "try"      >18 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try>try <block>{<br/></block></try></line>
<line class = "print"    >19 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Setting all preferences to default values."</literal></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "methodC"  >20 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>Globals<operator>.</operator>prefs<operator>.</operator>clear<argument_list>()</argument_list></call>;<br/></line>
<line class = "catch"    >21 <block>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block> <catch>catch <parameter_list>(<parameter><decl>BackingStoreException e</decl></parameter>)</parameter_list> <block>{<br/></block></catch></line>
<line class = "printE"   >22 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Unable to clear preferences."</literal></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "methodC"  >23 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>e<operator>.</operator>printStackTrace<argument_list>()</argument_list></call>;<br/></line>
<line class = "nothing"  >24 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></catch></try><br/></line>
<line class = "controlS" >25 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <else>else <block>{<br/></block></else></line>
<line class = "declaration">26 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>String<index>[]</index> keys <init>= <call>value<operator>.</operator>split<argument_list>(<argument><literal type="string">","</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "for"     >27 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<for>for <control>(<init><decl>String key <range>: keys</range></decl></init>)</control> <block>{<br/></block></for></line>
<line class = "controlS">28 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<call>Globals<operator>.</operator>prefs<operator>.</operator>hasKey<argument_list>(<argument><call>key<operator>.</operator>trim<argument_list>()</argument_list></call></argument>)</argument_list></call>)</condition><then> <block>{<br/></line>
<line class = "print">29 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Resetting preference key '%0'"</literal></argument>, <argument><call>key<operator>.</operator>trim<argument_list>()</argument_list></call></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "methodC">30 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>Globals<operator>.</operator>prefs<operator>.</operator>clear<argument_list>(<argument><call>key<operator>.</operator>trim<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "contorlS">31 <then><block>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <else>else <block>{<br/></line>
<line class = "print">32 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Unknown preference key '%0'"</literal></argument>, <argument><call>key<operator>.</operator>trim<argument_list>()</argument_list></call></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >33 <if><else><block>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></else></if><br/></line>
<line class = "nothing"  >34 <for><block>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></for><br/></line>
<line class = "nothing"  >35 <if>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></else></if><br/></line>
<line class = "nothing"  >36 <br/></line>
<line class = "nothing"  >37 &nbsp;&nbsp;&nbsp;}</block></then></if><br/></line>
<line class = "nothing"  >38 <br/></line>
<line class = "nothing"  >39 &nbsp;&nbsp;&nbsp;<comment type="line">// Check if we should import preferences from a file:</comment><br/></line>
<line class = "controlS">40 &nbsp;&nbsp;&nbsp;<if>if <condition>(<call>cli<operator>.</operator>isPreferencesImport<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "try">41 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try>try <block>{<br/></block></try></line>
<line class = "methodC">42 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>Globals<operator>.</operator>prefs<operator>.</operator>importPreferences<argument_list>(<argument><call>cli<operator>.</operator>getPreferencesImport<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "methodC">43 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>CustomEntryTypesManager<operator>.</operator>loadCustomEntryTypes<argument_list>(<argument>Globals<operator>.</operator>prefs</argument>)</argument_list></call>;<br/></line>
<line class = "methodC">44 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>ExportFormats<operator>.</operator>initAllExports<argument_list>()</argument_list></call>;<br/></line>
<line class = "catch">45 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block> <catch>catch <parameter_list>(<parameter><decl>JabRefException ex</decl></parameter>)</parameter_list> <block>{<br/></line>
<line class = "printE">46 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>LOGGER<operator>.</operator>error<argument_list>(<argument><literal type="string">"Cannot import preferences"</literal></argument>, <argument>ex</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >47 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try><catch><block>}</block></catch></try><br/></line>
<line class = "nothing"  >48 &nbsp;&nbsp;&nbsp;}</block></then></if><br/></line>
<line class = "nothing"  >49 <br/></line>
<line class = "nothing"  >50 &nbsp;&nbsp;&nbsp;<comment type="line">// Vector to put imported/loaded database(s) in.</comment><br/></line>
<line class = "decl">51 &nbsp;&nbsp;&nbsp;<decl_stmt><decl>Vector<argument_list type="generic">&lt;<argument>ParserResult</argument>&gt;</argument_list> loaded <init>= <operator>new</operator> <call>Vector<argument_list type="generic">&lt;&gt;</argument_list><argument_list>()</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "decl">52 &nbsp;&nbsp;&nbsp;<decl_stmt><decl>Vector<argument_list type="generic">&lt;<argument>String</argument>&gt;</argument_list> toImport <init>= <operator>new</operator> <call>Vector<argument_list type="generic">&lt;&gt;</argument_list><argument_list>()</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "controlS">53 &nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>cli<operator>.</operator>isBlank<argument_list>()</argument_list></call> <operator>&amp;&amp;</operator> <operator>(</operator><call>cli<operator>.</operator>getLeftOver<argument_list>()</argument_list></call><operator>.</operator>length <operator>&gt;</operator> <literal type="number">0</literal><operator>)</operator>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "for" >54 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<for>for <control>(<init><decl>String aLeftOver <range>: <call>cli<operator>.</operator>getLeftOver<argument_list>()</argument_list></call></range></decl></init>)</control> <block>{<br/></block></for></line></line>
<line class = "nothing"  >55 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// Leftover arguments that have a "bib" extension are interpreted as</comment><br/></line>
<line class = "nothing"  >56 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// bib files to open. Other files, and files that could not be opened</comment><br/></line>
<line class = "nothing"  >57 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// as bib, we try to import instead.</comment><br/></line>
<line class = "decl">58 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>boolean bibExtension <init>= <call>aLeftOver<operator>.</operator>toLowerCase<argument_list>()</argument_list></call><operator>.</operator><call>endsWith<argument_list>(<argument><literal type="string">"bib"</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "decl">59 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult pr <init>= <literal type="null">null</literal></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >60 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(bibExtension)</condition><then> <block>{<br/></block></then></if></line>
<line class = "Asignmt">61 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr <operator>=</operator> <call>JabRef<operator>.</operator>openBibFile<argument_list>(<argument>aLeftOver</argument>, <argument><literal type="boolean">false</literal></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >62 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >63 <br/></line>
<line class = "controlS">64 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>(</operator>pr <operator>==</operator> <literal type="null">null</literal><operator>)</operator> <operator>||</operator> <operator>(</operator>pr <operator>==</operator> ParserResult<operator>.</operator>INVALID_FORMAT<operator>)</operator>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "nothing"  >65 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// We will try to import this file. Normally we</comment><br/></line>
<line class = "nothing"  >66 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// will import it into a new tab, but if this import has</comment><br/></line>
<line class = "nothing"  >67 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// been initiated by another instance through the remote</comment><br/></line>
<line class = "nothing"  >68 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// listener, we will instead import it into the current database.</comment><br/></line>
<line class = "nothing"  >69 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// This will enable easy integration with web browsers that can</comment><br/></line>
<line class = "nothing"  >70 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// open a reference file in JabRef.</comment><br/></line>
<line class = "controlS">71 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(initialStartup)</condition><then> <block>{<br/></block></then></if></line>
<line class = "Asignmt">72 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>toImport<operator>.</operator>add<argument_list>(<argument>aLeftOver</argument>)</argument_list></call>;<br/></line>
<line class = "controlS">73 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<then><block>}</block></then> <else>else <block>{<br/></block></else></line>
<line class = "Asignmt">74 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult res <init>= <call>JabRef<operator>.</operator>importToOpenBase<argument_list>(<argument>aLeftOver</argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "controlS">75 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(res <operator>!=</operator> <literal type="null">null</literal>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "Asignmt">76 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>loaded<operator>.</operator>add<argument_list>(<argument>res</argument>)</argument_list></call>;<br/></line>
<line class = "controlS">77 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<then><block>}</block></then> <else>else <block>{<br/></block></else></line>
<line class = "controlS">78 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>loaded<operator>.</operator>add<argument_list>(<argument>ParserResult<operator>.</operator>INVALID_FORMAT</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >79 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></else></if><br/></line>
<line class = "nothing"  >80 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><else><block>}</block></else></if><br/></line>
<line class = "controlS">81 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <elseif>else <if>if <condition>(pr <operator>!=</operator> ParserResult<operator>.</operator>FILE_LOCKED)</condition><then> <block>{<br/></block></then></if></elseif></line>
<line class = "methodC">82 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>loaded<operator>.</operator>add<argument_list>(<argument>pr</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >83 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><elseif><if><then><block>}</block></then></if></elseif></if><br/></line>
<line class = "nothing"  >84 <br/></line>
<line class = "nothing"  >85 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<for><block>}</block></for><br/></line>
<line class = "nothing"  >86 &nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >87 <br/></line>
<line class = "controlS">88 &nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>cli<operator>.</operator>isBlank<argument_list>()</argument_list></call> <operator>&amp;&amp;</operator> <call>cli<operator>.</operator>isFileImport<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></line>
<line class = "methodC">89 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>toImport<operator>.</operator>add<argument_list>(<argument><call>cli<operator>.</operator>getFileImport<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >90 &nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >91 <br/></line>
<line class = "for">92 &nbsp;&nbsp;&nbsp;<for>for <control>(<init><decl>String filenameString <range>: toImport</range></decl></init>)</control> <block>{<br/></block></for></line>
<line class = "Asignmt">93 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult pr <init>= <call>JabRef<operator>.</operator>importFile<argument_list>(<argument>filenameString</argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "controlS">94 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(pr <operator>!=</operator> <literal type="null">null</literal>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "methodC">95 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>loaded<operator>.</operator>add<argument_list>(<argument>pr</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >96 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >97 &nbsp;&nbsp;&nbsp;<for><block>}</block></for><br/></line>
<line class = "nothing"  >98 <br/></line>
<line class = "controlS">99 &nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>cli<operator>.</operator>isBlank<argument_list>()</argument_list></call> <operator>&amp;&amp;</operator> <call>cli<operator>.</operator>isImportToOpenBase<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "Asignmt">100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult res <init>= <call>JabRef<operator>.</operator>importToOpenBase<argument_list>(<argument><call>cli<operator>.</operator>getImportToOpenBase<argument_list>()</argument_list></call></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "controlS">101&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(res <operator>!=</operator> <literal type="null">null</literal>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "Asignmt">102&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>loaded<operator>.</operator>add<argument_list>(<argument>res</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >103&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >104&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >105<br/></line>
<line class = "controlS">106&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>cli<operator>.</operator>isBlank<argument_list>()</argument_list></call> <operator>&amp;&amp;</operator> <call>cli<operator>.</operator>isFetcherEngine<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "decl">107&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult res <init>= <call>fetch<argument_list>(<argument><call>cli<operator>.</operator>getFetcherEngine<argument_list>()</argument_list></call></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >108&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(res <operator>!=</operator> <literal type="null">null</literal>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "nothing"  >109&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>loaded<operator>.</operator>add<argument_list>(<argument>res</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >110&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >111&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >112<br/></line>
<line class = "controlS">113&nbsp;&nbsp;&nbsp;<if>if <condition>(<call>cli<operator>.</operator>isExportMatches<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "controlS">114&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>loaded<operator>.</operator>isEmpty<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "decls ">115&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>String<index>[]</index> data <init>= <call>cli<operator>.</operator>getExportMatches<argument_list>()</argument_list></call><operator>.</operator><call>split<argument_list>(<argument><literal type="string">","</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "decl">116&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>String searchTerm <init>= data<index>[<literal type="number">0</literal>]</index><operator>.</operator><call>replace<argument_list>(<argument><literal type="string">"\\$"</literal></argument>, <argument><literal type="string">" "</literal></argument>)</argument_list></call></init></decl>;</decl_stmt> <comment type="line">//enables blanks within the search term:</comment><br/></line>
<line class = "nothing"  >117&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <comment type="line">//? stands for a blank</comment><br/></line>
<line class = "decls">118&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult pr <init>= <call>loaded<operator>.</operator>elementAt<argument_list>(<argument><call>loaded<operator>.</operator>size<argument_list>()</argument_list></call> <operator>-</operator> <literal type="number">1</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "decl">119&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>BibtexDatabase dataBase <init>= <call>pr<operator>.</operator>getDatabase<argument_list>()</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "decl">120&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>SearchManagerNoGUI smng <init>= <operator>new</operator> <call>SearchManagerNoGUI<argument_list>(<argument>searchTerm</argument>, <argument>dataBase</argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "decl">121&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>BibtexDatabase newBase <init>= <call>smng<operator>.</operator>getDBfromMatches<argument_list>()</argument_list></call></init></decl>;</decl_stmt> <comment type="line">//newBase contains only match entries</comment><br/></line>
<line class = "nothing"  >122<br/></line>
<line class = "nothing"  >123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">//export database</comment><br/></line>
<line class = "controlS">124&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>(</operator>newBase <operator>!=</operator> <literal type="null">null</literal><operator>)</operator> <operator>&amp;&amp;</operator> <operator>(</operator><call>newBase<operator>.</operator>getEntryCount<argument_list>()</argument_list></call> <operator>&gt;</operator> <literal type="number">0</literal><operator>)</operator>)</condition><then> <block>{<br/></line>
<line class = "decl">125&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>String formatName <init>= <literal type="null">null</literal></init></decl>;</decl_stmt><br/></line>
<line class = "decl">126&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>IExportFormat format</decl>;</decl_stmt><br/></line>
<line class = "nothing"  >127<br/></line>
<line class = "nothing"  >128&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">//read in the export format, take default format if no format entered</comment><br/></line>
<line class = "controlS">129&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<switch>switch <condition>(data<operator>.</operator>length)</condition> <block>{<br/></line>
<line class = "nothing"  >130&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<case>case <literal type="number">3</literal>:</case><br/></line>
<line class = "Asignmt">131&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatName <operator>=</operator> data<index>[<literal type="number">2</literal>]</index>;<br/></line>
<line class = "break">132&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<break>break;</break><br/></line>
<line class = "nothing"  >133&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<case>case <literal type="number">2</literal>:</case><br/></line>
<line class = "nothing"  >134&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">//default ExportFormat: HTML table (with Abstract &amp; BibTeX)</comment><br/></line>
<line class = "Asignmt">135&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatName <operator>=</operator> <literal type="string">"tablerefsabsbib"</literal>;<br/></line>
<line class = "break">136&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<break>break;</break><br/></line>
<line class = "controlS">137&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<default>default:</default><br/></line>
<line class = "printE">138&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<br/></argument_list></call></line>
<line class = "methodC">139&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Output file missing"</literal></argument>)</argument_list></call><operator>.</operator><call>concat<argument_list>(<argument><literal type="string">". \n \t "</literal></argument>)</argument_list></call><operator>.</operator><call>concat<argument_list>(<argument><literal type="string">"Usage"</literal></argument>)</argument_list></call><operator>.</operator><call>concat<argument_list>(<argument><literal type="string">": "</literal></argument>)</argument_list></call><br/></argument></line>
<line class = "methodC">140&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call><argument_list><argument><operator>+</operator> <call>JabRefCLI<operator>.</operator>getExportMatchesSyntax<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "return">141&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<return>return <literal type="null">null</literal>;</return> <comment type="line">// TODO replace with optional one day</comment><br/></line>
<line class = "nothing"  >142&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<switch><block>}</block></switch> <comment type="line">//end switch</comment><br/></line>
<line class = "nothing"  >143<br/></line>
<line class = "nothing"  >144&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">//export new database</comment><br/></line>
<line class = "Asignmt">145&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format <operator>=</operator> <call>ExportFormats<operator>.</operator>getExportFormat<argument_list>(<argument>formatName</argument>)</argument_list></call>;<br/></line>
<line class = "controlS">146&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(format <operator>!=</operator> <literal type="null">null</literal>)</condition><then> <block>{<br/></line>
<line class = "nothing"  >147&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// We have an ExportFormat instance:</comment><br/></line>
<line class = "try">148&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try>try <block>{<br/></block></try></line>
<line class = "print">149&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Exporting"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">": "</literal> <operator>+</operator> data<index>[<literal type="number">1</literal>]</index></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >150&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>format<operator>.</operator>performExport<argument_list>(<argument>newBase</argument>, <argument><call>pr<operator>.</operator>getMetaData<argument_list>()</argument_list></call></argument>, <argument>data<index>[<literal type="number">1</literal>]</index></argument>, <argument><call>pr<operator>.</operator>getEncoding<argument_list>()</argument_list></call></argument>, <argument><literal type="null">null</literal></argument>)</argument_list></call>;<br/></line>
<line class = "methodC">151&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<block>}</block> <catch>catch <parameter_list>(<parameter><decl>Exception ex</decl></parameter>)</parameter_list> <block>{<br/></block></catch></line>
<line class = "printE">152&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Could not export file"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">" '"</literal> <operator>+</operator> data<index>[<literal type="number">1</literal>]</index> <operator>+</operator> <literal type="string">"': "</literal><br/></argument></argument_list></call></line>
<line class = "methodC">153&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<operator>+</operator> <call>ex<operator>.</operator>getMessage<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >154&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></catch></try><br/></line>
<line class = "controlS">155&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<block>}</block></then> <else>else <block>{<br/></line>
<line class = "printE">156&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Unknown export format"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">": "</literal> <operator>+</operator> formatName</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >157&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></else></if><br/></line>
<line class = "controlS">158&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <comment type="block">/*end if newBase != null*/</comment><else>else <block>{<br/></line>
<line class = "print">159&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"No search matches."</literal></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >160&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><else><block>}</block></else></if><br/></line>
<line class = "controlS">161&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<then><block>}</block></then> <else>else <block>{<br/></block></else></line>
<line class = "print">162&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"The output option depends on a valid input option."</literal></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "comment"  >163&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><else><block>}</block></else></if> <comment type="line">//end if(loaded.size &gt; 0)</comment><br/></line>
<line class = "nothing"  >164&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >165<br/></line>
<line class = "controlS">166&nbsp;&nbsp;&nbsp;<if>if <condition>(<call>cli<operator>.</operator>isFileExport<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "controlS">167&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>loaded<operator>.</operator>isEmpty<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></line>
<line class = "decl">168&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>String<index>[]</index> data <init>= <call>cli<operator>.</operator>getFileExport<argument_list>()</argument_list></call><operator>.</operator><call>split<argument_list>(<argument><literal type="string">","</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >169<br/></line>
<line class = "controlS">170&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(data<operator>.</operator>length <operator>==</operator> <literal type="number">1</literal>)</condition><then> <block>{<br/></line>
<line class = "comment"  >171&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// This signals that the latest import should be stored in BibTeX</comment><br/></line>
<line class = "comment"  >172&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// format to the given file.</comment><br/></line>
<line class = "controlS">173&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>loaded<operator>.</operator>isEmpty<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "Asignmt">174&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult pr <init>= <call>loaded<operator>.</operator>elementAt<argument_list>(<argument><call>loaded<operator>.</operator>size<argument_list>()</argument_list></call> <operator>-</operator> <literal type="number">1</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "controlS">175&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>pr<operator>.</operator>isInvalid<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "try">176&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try>try <block>{<br/></block></try></line>
<line class = "print">177&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Saving"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">": "</literal> <operator>+</operator> data<index>[<literal type="number">0</literal>]</index></argument>)</argument_list></call>;<br/></line>
<line class = "decl">178&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>SaveSession session <init>= <call>FileActions<operator>.</operator>saveDatabase<argument_list>(<argument><call>pr<operator>.</operator>getDatabase<argument_list>()</argument_list></call></argument>, <argument><call>pr<operator>.</operator>getMetaData<argument_list>()</argument_list></call></argument>,<br/></argument_list></call></init></decl></decl_stmt></line>
<line class = "decl">179&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><operator>new</operator> <call>File<argument_list>(<argument>data<index>[<literal type="number">0</literal>]</index></argument>)</argument_list></call></argument>, <argument>Globals<operator>.</operator>prefs</argument>, <argument><literal type="boolean">false</literal></argument>, <argument><literal type="boolean">false</literal></argument>,<br/></line>
<line class = "methodC">180&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><call>Globals<operator>.</operator>prefs<operator>.</operator>get<argument_list>(<argument>JabRefPreferences<operator>.</operator>DEFAULT_ENCODING</argument>)</argument_list></call></argument>, <argument><literal type="boolean">false</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "comment"  >181&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// Show just a warning message if encoding didn't work for all characters:</comment><br/></line>
<line class = "controlS">182&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>session<operator>.</operator>getWriter<argument_list>()</argument_list></call><operator>.</operator><call>couldEncodeAll<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></line>
<line class = "printE">183&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Warning"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">": "</literal><br/></argument></argument_list></call></line>
<line class = "printE">184&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<operator>+</operator> <call>Localization<operator>.</operator>lang<argument_list>(<br/></argument_list></call></line>
<line class = "nothing"  >185&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><literal type="string">"The chosen encoding '%0' could not encode the following characters: "</literal></argument>,<br/></line>
<line class = "methodC">186&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><call>session<operator>.</operator>getEncoding<argument_list>()</argument_list></call></argument>)</argument_list></call><br/></line>
<line class = "methodC">187&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<operator>+</operator> <call>session<operator>.</operator>getWriter<argument_list>()</argument_list></call><operator>.</operator><call>getProblemCharacters<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >188&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then></if><br/></line>
<line class = "methodC">189&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>session<operator>.</operator>commit<argument_list>()</argument_list></call>;<br/></line>
<line class = "catch">190&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<block>}</block> <catch>catch <parameter_list>(<parameter><decl>SaveException ex</decl></parameter>)</parameter_list> <block>{</block></catch><br/></line>
<line class = "printE">191&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Could not save file."</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">"\n"</literal><br/></argument></argument_list></call></line>
<lineclass = "printE">192&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call><argument_list><argument><operator>+</operator> <call>ex<operator>.</operator>getLocalizedMessage<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >193&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try><catch><block>}</block></catch></try><br/></line>
<line class = "nothing"  >194&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "controlS">195&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<then><block>}</block></then> <else>else <block>{<br/></block></else></line>
<line class = "printE">196&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"The output option depends on a valid import option."</literal></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >197&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><else><block>}</block></else></if><br/></line>
<line class = "controlS">198&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <elseif>else <if>if <condition>(data<operator>.</operator>length <operator>==</operator> <literal type="number">2</literal>)</condition><then> <block>{<br/></block></then></if></elseif></line>
<line class = "nothing"  >199&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// This signals that the latest import should be stored in the given</comment><br/></line>
<line class = "nothing"  >200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// format to the given file.</comment><br/></line>
<line class = "decl">201&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult pr <init>= <call>loaded<operator>.</operator>elementAt<argument_list>(<argument><call>loaded<operator>.</operator>size<argument_list>()</argument_list></call> <operator>-</operator> <literal type="number">1</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >202<br/></line>
<line class = "nothing"  >203&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// Set the global variable for this database's file directory before exporting,</comment><br/></line>
<line class = "nothing"  >204&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// so formatters can resolve linked files correctly.</comment><br/></line>
<line class = "nothing"  >205&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// (This is an ugly hack!)</comment><br/></line>
<line class = "decl">206&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>File theFile <init>= <call>pr<operator>.</operator>getFile<argument_list>()</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "controlS">207&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>theFile<operator>.</operator>isAbsolute<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></block></then></if></line>
<line class = "Asignmt">208&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theFile <operator>=</operator> <call>theFile<operator>.</operator>getAbsoluteFile<argument_list>()</argument_list></call>;<br/></line>
<line class = "nothing"  >209&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "decl">210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>MetaData metaData <init>= <call>pr<operator>.</operator>getMetaData<argument_list>()</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "Asignmt">211&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>metaData<operator>.</operator>setFile<argument_list>(<argument>theFile</argument>)</argument_list></call>;<br/></line>
<line class = "Asignmt">212&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Globals<operator>.</operator>prefs<operator>.</operator>fileDirForDatabase <operator>=</operator> <call>metaData<operator>.</operator>getFileDirectory<argument_list>(<argument>Globals<operator>.</operator>FILE_FIELD</argument>)</argument_list></call>;<br/></line>
<line class = "Asignmt">213&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Globals<operator>.</operator>prefs<operator>.</operator>databaseFile <operator>=</operator> <call>metaData<operator>.</operator>getFile<argument_list>()</argument_list></call>;<br/></line>
<line class = "print">214&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Exporting"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">": "</literal> <operator>+</operator> data<index>[<literal type="number">0</literal>]</index></argument>)</argument_list></call>;<br/></line>
<line class = "decl">215&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>IExportFormat format <init>= <call>ExportFormats<operator>.</operator>getExportFormat<argument_list>(<argument>data<index>[<literal type="number">1</literal>]</index></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "controlS">216&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(format <operator>!=</operator> <literal type="null">null</literal>)</condition><then> <block>{<br/></line>
<line class = "nothing"  >217&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// We have an ExportFormat instance:</comment><br/></line>
<lineclass = "try">218&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try>try <block>{<br/></line>
<line class = "methodC">219&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>format<operator>.</operator>performExport<argument_list>(<argument><call>pr<operator>.</operator>getDatabase<argument_list>()</argument_list></call></argument>, <argument><call>pr<operator>.</operator>getMetaData<argument_list>()</argument_list></call></argument>, <argument>data<index>[<literal type="number">0</literal>]</index></argument>, <argument><call>pr<operator>.</operator>getEncoding<argument_list>()</argument_list></call></argument>, <argument><literal type="null">null</literal></argument>)</argument_list></call>;<br/></line>
<line class = "catch">220&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block> <catch>catch <parameter_list>(<parameter><decl>Exception ex</decl></parameter>)</parameter_list> <block>{<br/></line>
<lineclass = "">221&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Could not export file"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">" '"</literal> <operator>+</operator> data<index>[<literal type="number">0</literal>]</index> <operator>+</operator> <literal type="string">"': "</literal><br/></line>
<lineclass = "methodC">222&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<operator>+</operator> <call>ex<operator>.</operator>getMessage<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >223&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></catch></try><br/></line>
<lineclass = "controlS">224&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <else>else <block>{<br/></line>
<lineclass = "printE">225&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Unknown export format"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">": "</literal> <operator>+</operator> data<index>[<literal type="number">1</literal>]</index></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >226&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></else></if><br/></line>
<line class = "nothing"  >227<br/></line>
<line class = "nothing"  >228&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then></if></elseif></if><br/></line>
<line class = "controlS">229&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <else>else <block>{<br/></line>
<line class = "printE">230&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"The output option depends on a valid import option."</literal></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >231&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></else></if><br/></line>
<line class = "nothing"  >232&nbsp;&nbsp;&nbsp;}</block></then></if><br/></line>
<line class = "nothing"  >233<br/></line>
<line class = "printE">234&nbsp;&nbsp;&nbsp;<call>LOGGER<operator>.</operator>debug<argument_list>(<argument><literal type="string">"Finished export"</literal></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >235<br/></line>
<line class = "controlS">236&nbsp;&nbsp;&nbsp;<if>if <condition>(<call>cli<operator>.</operator>isPreferencesExport<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></line>
<line class = "try">237&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try>try <block>{<br/></line>
<line class = "methodC">238&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>Globals<operator>.</operator>prefs<operator>.</operator>exportPreferences<argument_list>(<argument><call>cli<operator>.</operator>getPreferencesExport<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "catch">239&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block> <catch>catch <parameter_list>(<parameter><decl>JabRefException ex</decl></parameter>)</parameter_list> <block>{<br/></line>
<line class = "printE">240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>LOGGER<operator>.</operator>error<argument_list>(<argument><literal type="string">"Cannot export preferences"</literal></argument>, <argument>ex</argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >241&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></catch></try><br/></line>
<line class = "nothing"  >242&nbsp;&nbsp;&nbsp;}</block></then></if><br/></line>
<line class = "nothing"  >243<br/></line>
<line class = "controlS">244&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>cli<operator>.</operator>isBlank<argument_list>()</argument_list></call> <operator>&amp;&amp;</operator> <call>cli<operator>.</operator>isAuxImport<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></line>
<line class = "decl">245&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>boolean usageMsg <init>= <literal type="boolean">false</literal></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >246<br/></line>
<line class = "controlS">247&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>loaded<operator>.</operator>isEmpty<argument_list>()</argument_list></call>)</condition><then> <comment type="line">// bibtex file loaded</comment><br/></line>
<line class = "nothing"  >248&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<block>{<br/></line>
<line class = "decl">249&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>String<index>[]</index> data <init>= <call>cli<operator>.</operator>getAuxImport<argument_list>()</argument_list></call><operator>.</operator><call>split<argument_list>(<argument><literal type="string">","</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >250<br/></line>
<line class = "controlS">251&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(data<operator>.</operator>length <operator>==</operator> <literal type="number">2</literal>)</condition><then> <block>{<br/></line>
<line class = "decl">252&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>ParserResult pr <init>= <call>loaded<operator>.</operator>firstElement<argument_list>()</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "decl">253&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>AuxCommandLine acl <init>= <operator>new</operator> <call>AuxCommandLine<argument_list>(<argument>data<index>[<literal type="number">0</literal>]</index></argument>, <argument><call>pr<operator>.</operator>getDatabase<argument_list>()</argument_list></call></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "decl">254&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>BibtexDatabase newBase <init>= <call>acl<operator>.</operator>perform<argument_list>()</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >255<br/></line>
<line class = "decl">256&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>boolean notSavedMsg <init>= <literal type="boolean">false</literal></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >257<br/></line>
<line class = "nothing"  >258&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// write an output, if something could be resolved</comment><br/></line>
<line class = "nothing"  >259&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/></line>
<line class = "controlS">260&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(newBase <operator>!=</operator> <literal type="null">null</literal>)</condition><then> <block>{<br/></line>
<line class = "controlS">261&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<call>newBase<operator>.</operator>getEntryCount<argument_list>()</argument_list></call> <operator>&gt;</operator> <literal type="number">0</literal>)</condition><then> <block>{<br/></line>
<line class = "decl">262&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>String subName <init>= <call>StringUtil<operator>.</operator>getCorrectFileName<argument_list>(<argument>data<index>[<literal type="number">1</literal>]</index></argument>, <argument><literal type="string">"bib"</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >263<br/></line>
<line class = "try">264&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<try>try <block>{<br/></line>
<line class = "print">265&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Saving"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">": "</literal> <operator>+</operator> subName</argument>)</argument_list></call>;<br/></line>
<line class = "decl">266&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<decl_stmt><decl>SaveSession session <init>= <call>FileActions<operator>.</operator>saveDatabase<argument_list>(<argument>newBase</argument>, <argument><operator>new</operator> <call>MetaData<argument_list>()</argument_list></call></argument>, <comment type="line">// no Metadata</comment><br/></line>
<line class = "methodArgs">267&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><operator>new</operator> <call>File<argument_list>(<argument>subName</argument>)</argument_list></call></argument>, <argument>Globals<operator>.</operator>prefs</argument>, <argument><literal type="boolean">false</literal></argument>, <argument><literal type="boolean">false</literal></argument>,<br/></line>
<line class = "methodArgs">268&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><call>Globals<operator>.</operator>prefs<operator>.</operator>get<argument_list>(<argument>JabRefPreferences<operator>.</operator>DEFAULT_ENCODING</argument>)</argument_list></call></argument>, <argument><literal type="boolean">false</literal></argument>)</argument_list></call></init></decl>;</decl_stmt><br/></line>
<line class = "nothing"  >269&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<comment type="line">// Show just a warning message if encoding didn't work for all characters:</comment><br/></line>
<line class = "controlS">270&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator><call>session<operator>.</operator>getWriter<argument_list>()</argument_list></call><operator>.</operator><call>couldEncodeAll<argument_list>()</argument_list></call>)</condition><then> <block>{<br/></line>
<line class = "printE">271&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Warning"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">": "</literal><br/></argument></argument_list></call></line>
<line class = "print">272&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<operator>+</operator> <call>Localization<operator>.</operator>lang<argument_list>(<br/></line>
<line class = "nothing"  >273&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><literal type="string">"The chosen encoding '%0' could not encode the following characters: "</literal></argument>,<br/></line>
<line class = "methodC">274&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<argument><call>session<operator>.</operator>getEncoding<argument_list>()</argument_list></call></argument>)</argument_list></call><br/></line>
<line class = "methodC">275&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call><argument_list><argument><operator>+</operator> <call>session<operator>.</operator>getWriter<argument_list>()</argument_list></call><operator>.</operator><call>getProblemCharacters<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >276&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "methodC">277&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>session<operator>.</operator>commit<argument_list>()</argument_list></call>;<br/></line>
<line class = "catch">278&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block> <catch>catch <parameter_list>(<parameter><decl>SaveException ex</decl></parameter>)</parameter_list> <block>{<br/></block></catch></line>
<line class = "printE">279&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>err<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"Could not save file."</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">"\n"</literal><br/></argument></argument_list></call></line>
<line class = "methodC">280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call><argument_list><argument><operator>+</operator> <call>ex<operator>.</operator>getLocalizedMessage<argument_list>()</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >281&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></catch></try><br/></line>
<line class = "nothing"  >282<br/></line>
<line class = "Asignmt">283&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notSavedMsg <operator>=</operator> <literal type="boolean">true</literal>;<br/></line>
<line class = "nothing"  >284&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then></if><br/></line>
<line class = "nothing"  >285&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >286<br/></line>
<line class = "controlS">287&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(<operator>!</operator>notSavedMsg)</condition><then> <block>{<br/></line>
<line class = "print">288&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"no database generated"</literal></argument>)</argument_list></call></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >289&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "controlS">290&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <else>else <block>{<br/></block></else></line>
<line class = "Asignmt">291&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usageMsg <operator>=</operator> <literal type="boolean">true</literal>;<br/></line>
<line class = "nothing"  >292&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><else><block>}</block></else></if><br/></line>
<line class = "controlS">293&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></then> <else>else <block>{<br/></line>
<line class = "Asignmt">294&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usageMsg <operator>=</operator> <literal type="boolean">true</literal>;<br/></line>
<line class = "nothing"  >295&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</block></else></if><br/></line>
<line class = "nothing"  >296<br/></line>
<line class = "controlS">297&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if>if <condition>(usageMsg)</condition><then> <block>{<br/></line>
<line class = "print">298&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"no base-BibTeX-file specified"</literal></argument>)</argument_list></call><operator>+</operator><literal type="string">"!"</literal></argument>)</argument_list></call>;<br/></line>
<line class = "print">299&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><call>Localization<operator>.</operator>lang<argument_list>(<argument><literal type="string">"usage"</literal></argument>)</argument_list></call> <operator>+</operator> <literal type="string">" :"</literal></argument>)</argument_list></call>;<br/></line>
<line class = "print">300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<call>System<operator>.</operator>out<operator>.</operator>println<argument_list>(<argument><literal type="string">"jabref --aux infile[.aux],outfile[.bib] base-BibTeX-file"</literal></argument>)</argument_list></call>;<br/></line>
<line class = "nothing"  >301&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >302&nbsp;&nbsp;&nbsp;<if><then><block>}</block></then></if><br/></line>
<line class = "nothing"  >303<br/></line>
<line class = "return">304&nbsp;&nbsp;&nbsp;<return>return loaded;</return><br/></line>
<line class = "nothing"  >305<function><block>}</block></function><br/></line>
</body></html>
